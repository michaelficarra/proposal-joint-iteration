"use strict";
if (typeof Iterator === 'undefined' || Iterator == null) {
    globalThis.Iterator = {};
}
const DEFAULT_FILLER = void 0;
function getIteratorFlattenable(obj, stringHandling) {
    if (Object(obj) !== obj) {
        if (stringHandling === 'reject-strings' || typeof obj != 'string') {
            throw new TypeError;
        }
    }
    let iter = Symbol.iterator in obj ? obj[Symbol.iterator]() : obj;
    if (Object(iter) !== iter) {
        throw new TypeError;
    }
    return iter;
}
function isObject(obj) {
    return Object(obj) === obj;
}
function getOwnEnumerablePropertyKeys(obj) {
    let descriptors = Object.getOwnPropertyDescriptors(obj);
    let keys = Reflect.ownKeys(obj);
    return keys.filter(k => descriptors[k].enumerable);
}
;
function* zipImpl(input, options) {
    if (!isObject(input)) {
        throw new TypeError;
    }
    if (options === undefined) {
        options = Object.create(null);
    }
    if (!isObject(options)) {
        throw new TypeError;
    }
    let longest = options.longest;
    let strict = options.strict;
    if (longest && strict) {
        throw new TypeError;
    }
    let mode = longest ? 'longest' : (strict ? 'strict' : 'shortest');
    if (Symbol.iterator in input) {
        yield* zipPositional(input, mode, options);
    }
    else {
        yield* zipNamed(input, mode, options);
    }
}
function getResults(iters, nexts) {
    return nexts.map(({ done, next }, i) => {
        if (done)
            return { done: true };
        try {
            let v = next.call(iters[i]);
            return v.done ? { done: true } : { done: false, value: v.value };
        }
        catch (e) {
            for (let k = 0; k < nexts.length; ++k) {
                if (k === i)
                    continue;
                try {
                    if (!nexts[k].done) {
                        iters[k].return?.();
                    }
                }
                catch { }
            }
            throw e;
        }
    });
}
function* zipCore(iters, mode, padding) {
    if (iters.length === 0)
        return;
    let nexts = iters.map((iter, i) => {
        try {
            return ({ done: false, next: iter.next });
        }
        catch (e) {
            for (let k = 0; k < iters.length; ++k) {
                if (k === i)
                    continue;
                try {
                    iters[k].return?.();
                }
                catch { }
            }
            throw e;
        }
    });
    while (true) {
        let results = getResults(iters, nexts);
        results.forEach((r, i) => {
            if (r.done) {
                nexts[i] = { done: true };
            }
        });
        switch (mode) {
            case 'shortest':
                if (results.some(r => r.done))
                    return;
                yield results.map(r => r.value);
                break;
            case 'longest':
                if (results.every(r => r.done))
                    return;
                yield results.map((r, i) => r.done ? padding[i] : r.value);
                break;
            case 'strict':
                if (results.every(r => r.done))
                    return;
                if (results.some(r => r.done)) {
                    throw new RangeError;
                }
                yield results.map(r => r.value);
                break;
        }
    }
}
function* zipPositional(input, mode, options) {
    let iters = [];
    let padding;
    try {
        for (let iter of input) {
            iters.push(getIteratorFlattenable(iter, 'iterate-strings'));
        }
        padding = iters.map(() => DEFAULT_FILLER);
        if (mode === 'longest') {
            let tmp = options.padding;
            if (tmp != null) {
                padding = Array.from(tmp);
            }
        }
    }
    catch (e) {
        for (let iter of iters) {
            try {
                iter.return?.();
            }
            catch { }
        }
        throw e;
    }
    yield* zipCore(iters, mode, padding);
}
function* zipNamed(input, mode, options) {
    let keys = getOwnEnumerablePropertyKeys(input);
    let padding = keys.map(() => DEFAULT_FILLER);
    let iters = [];
    try {
        for (let k of keys) {
            iters.push(getIteratorFlattenable(input[k], 'iterate-strings'));
        }
        if (mode === 'longest') {
            let tmp = options.padding;
            if (tmp != null) {
                padding = keys.map(k => tmp[k]);
            }
        }
    }
    catch (e) {
        for (let iter of iters) {
            try {
                iter.return?.();
            }
            catch { }
        }
        throw e;
    }
    for (let result of zipCore(iters, mode, padding)) {
        yield Object.fromEntries(result.map((r, i) => [keys[i], r]));
    }
}
const zip = (input, options = undefined) => zipImpl(input, options);
Object.defineProperty(Iterator, 'zip', {
    configurable: true,
    writable: true,
    enumerable: false,
    value: zip,
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLElBQUksT0FBTyxRQUFRLEtBQUssV0FBVyxJQUFJLFFBQVEsSUFBSSxJQUFJLEVBQUU7SUFDdkQsVUFBVSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7Q0FDMUI7QUFFRCxNQUFNLGNBQWMsR0FBRyxLQUFLLENBQUMsQ0FBQztBQUU5QixTQUFTLHNCQUFzQixDQUFDLEdBQVEsRUFBRSxjQUFvRDtJQUM1RixJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxHQUFHLEVBQUU7UUFDdkIsSUFBSSxjQUFjLEtBQUssZ0JBQWdCLElBQUksT0FBTyxHQUFHLElBQUksUUFBUSxFQUFFO1lBQ2pFLE1BQU0sSUFBSSxTQUFTLENBQUM7U0FDckI7S0FDRjtJQUNELElBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQXdCLENBQUM7SUFDdEYsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3pCLE1BQU0sSUFBSSxTQUFTLENBQUM7S0FDckI7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRCxTQUFTLFFBQVEsQ0FBQyxHQUFZO0lBQzVCLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQztBQUM3QixDQUFDO0FBRUQsU0FBUyw0QkFBNEIsQ0FBbUIsR0FBTTtJQUM1RCxJQUFJLFdBQVcsR0FBRyxNQUFNLENBQUMseUJBQXlCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDeEQsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQW1CLENBQUM7SUFDbEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENB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