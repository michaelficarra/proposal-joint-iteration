"use strict";
if (typeof Iterator === 'undefined' || Iterator == null) {
    globalThis.Iterator = {};
}
const DEFAULT_FILLER = void 0;
function getIteratorFlattenable(obj, stringHandling) {
    if (Object(obj) !== obj) {
        if (stringHandling === 'reject-strings' || typeof obj != 'string') {
            throw new TypeError;
        }
    }
    let iter = Symbol.iterator in obj ? obj[Symbol.iterator]() : obj;
    if (Object(iter) !== iter) {
        throw new TypeError;
    }
    return iter;
}
function isObject(obj) {
    return Object(obj) === obj;
}
function getOwnEnumerablePropertyKeys(obj) {
    let descriptors = Object.getOwnPropertyDescriptors(obj);
    let keys = Reflect.ownKeys(obj);
    return keys.filter(k => descriptors[k].enumerable);
}
;
function getMode(options) {
    let longest = options.longest;
    let strict = options.strict;
    if (longest && strict) {
        throw new TypeError;
    }
    return longest ? 'longest' : (strict ? 'strict' : 'shortest');
}
function* zipToArrays(input, options) {
    if (!isObject(input)) {
        throw new TypeError;
    }
    if (options === undefined) {
        options = Object.create(null);
    }
    if (!isObject(options)) {
        throw new TypeError;
    }
    let mode = getMode(options);
    let iters = [];
    let padding;
    try {
        for (let iter of input) {
            iters.push(getIteratorFlattenable(iter, 'iterate-strings'));
        }
        padding = iters.map(() => DEFAULT_FILLER);
        if (mode === 'longest') {
            let tmp = options.padding;
            if (tmp != null) {
                padding = Array.from(tmp);
            }
        }
    }
    catch (e) {
        for (let iter of iters) {
            try {
                iter.return?.();
            }
            catch { }
        }
        throw e;
    }
    yield* zipCore(iters, mode, padding);
}
function* zipToObjects(input, options) {
    if (!isObject(input)) {
        throw new TypeError;
    }
    if (options === undefined) {
        options = Object.create(null);
    }
    if (!isObject(options)) {
        throw new TypeError;
    }
    let mode = getMode(options);
    let keys = getOwnEnumerablePropertyKeys(input);
    let padding = keys.map(() => DEFAULT_FILLER);
    let iters = [];
    try {
        for (let k of keys) {
            iters.push(getIteratorFlattenable(input[k], 'iterate-strings'));
        }
        if (mode === 'longest') {
            let tmp = options.padding;
            if (tmp != null) {
                padding = keys.map(k => tmp[k]);
            }
        }
    }
    catch (e) {
        for (let iter of iters) {
            try {
                iter.return?.();
            }
            catch { }
        }
        throw e;
    }
    for (let result of zipCore(iters, mode, padding)) {
        yield Object.fromEntries(result.map((r, i) => [keys[i], r]));
    }
}
function getResults(iters, nexts) {
    return nexts.map(({ done, next }, i) => {
        if (done)
            return { done: true };
        try {
            let v = next.call(iters[i]);
            return v.done ? { done: true } : { done: false, value: v.value };
        }
        catch (e) {
            for (let k = 0; k < nexts.length; ++k) {
                if (k === i)
                    continue;
                try {
                    if (!nexts[k].done) {
                        iters[k].return?.();
                    }
                }
                catch { }
            }
            throw e;
        }
    });
}
function* zipCore(iters, mode, padding) {
    if (iters.length === 0)
        return;
    let nexts = iters.map((iter, i) => {
        try {
            return ({ done: false, next: iter.next });
        }
        catch (e) {
            for (let k = 0; k < iters.length; ++k) {
                if (k === i)
                    continue;
                try {
                    iters[k].return?.();
                }
                catch { }
            }
            throw e;
        }
    });
    while (true) {
        let results = getResults(iters, nexts);
        results.forEach((r, i) => {
            if (r.done) {
                nexts[i] = { done: true };
            }
        });
        switch (mode) {
            case 'shortest':
                if (results.some(r => r.done))
                    return;
                yield results.map(r => r.value);
                break;
            case 'longest':
                if (results.every(r => r.done))
                    return;
                yield results.map((r, i) => r.done ? padding[i] : r.value);
                break;
            case 'strict':
                if (results.every(r => r.done))
                    return;
                if (results.some(r => r.done)) {
                    throw new RangeError;
                }
                yield results.map(r => r.value);
                break;
        }
    }
}
Object.defineProperty(Iterator, 'zipToArrays', {
    configurable: true,
    writable: true,
    enumerable: false,
    value: zipToArrays,
});
Object.defineProperty(Iterator, 'zipToObjects', {
    configurable: true,
    writable: true,
    enumerable: false,
    value: zipToObjects,
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLElBQUksT0FBTyxRQUFRLEtBQUssV0FBVyxJQUFJLFFBQVEsSUFBSSxJQUFJLEVBQUU7SUFDdkQsVUFBVSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7Q0FDMUI7QUFFRCxNQUFNLGNBQWMsR0FBRyxLQUFLLENBQUMsQ0FBQztBQUU5QixTQUFTLHNCQUFzQixDQUFDLEdBQVEsRUFBRSxjQUFvRDtJQUM1RixJQUFJLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxHQUFHLEVBQUU7UUFDdkIsSUFBSSxjQUFjLEtBQUssZ0JBQWdCLElBQUksT0FBTyxHQUFHLElBQUksUUFBUSxFQUFFO1lBQ2pFLE1BQU0sSUFBSSxTQUFTLENBQUM7U0FDckI7S0FDRjtJQUNELElBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxRQUFRLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQXdCLENBQUM7SUFDdEYsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3pCLE1BQU0sSUFBSSxTQUFTLENBQUM7S0FDckI7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRCxTQUFTLFFBQVEsQ0FBQyxHQUFZO0lBQzVCLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEdBQUcsQ0FBQztBQUM3QixDQUFDO0FBRUQsU0FBUyw0QkFBNEIsQ0FBbUIsR0FBTTtJQUM1RCxJQUFJLFdBQVcsR0FBRyxNQUFNLENBQUMseUJBQXlCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDeEQsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQW1CLENBQUM7SUFDbEQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENB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